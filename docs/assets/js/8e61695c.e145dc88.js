"use strict";(self.webpackChunkdynamo_ql=self.webpackChunkdynamo_ql||[]).push([[1273],{7397:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var i=t(5893),s=t(1151);const r={},c=void 0,a={id:"model/API/transactWrite",title:"transactWrite",description:"Introduction",source:"@site/docs/model/API/transactWrite.mdx",sourceDirName:"model/API",slug:"/model/API/transactWrite",permalink:"/dynamoql-site/docs/model/API/transactWrite",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"transactUpdate",permalink:"/dynamoql-site/docs/model/API/transactUpdate"},next:{title:"update",permalink:"/dynamoql-site/docs/model/API/update"}},o={},d=[{value:"Introduction",id:"introduction",level:3},{value:"execute",id:"execute",level:3},{value:"check",id:"check",level:4},{value:"delete",id:"delete",level:4},{value:"put",id:"put",level:4},{value:"update",id:"update",level:4},{value:"options",id:"options",level:3},{value:"exec",id:"exec",level:4}];function l(e){const n={a:"a",br:"br",code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h3,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"transactWrite"})," method performs transact write request using aws-sdk ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/client/dynamodb/command/TransactWriteItemsCommand/",children:"TransactWriteItemsCommand"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"execute",children:"execute"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"transactWrite"})," takes 2 arguments:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["(required) an object which must include:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#check",children:"check"})," and/or ",(0,i.jsx)(n.a,{href:"#update",children:"update"})," and/or ",(0,i.jsx)(n.a,{href:"#",children:"put"})," and/or ",(0,i.jsx)(n.a,{href:"#",children:"delete"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnal) ",(0,i.jsx)(n.a,{href:"#options",children:"options"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"check",children:"check"}),"\n",(0,i.jsxs)(n.p,{children:["an array of ",(0,i.jsx)(n.a,{href:"/docs/schema/data-types/String#condition-expression",children:"Condition expression"})," with at least item identifier."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const res = await User.transactWrite({\n  check: [\n    {\n      id: "user-64",\n      isActive: false,\n    },\n  ],\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"delete",children:"delete"}),"\n",(0,i.jsx)(n.p,{children:"an array of object which includes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"condition"})," ",(0,i.jsx)(n.a,{href:"/docs/schema/data-types/String#condition-expression",children:"Condition expression"})," object with at least item identifier."]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnally) ",(0,i.jsx)(n.code,{children:"ReturnValuesOnConditionCheckFailure"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const res = await User.transactWrite({\n  delete: [\n    {\n      // highlight-next-line\n      condition: {\n        id: "user-64",\n        isActive: false,\n      },\n    },\n  ],\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"put",children:"put"}),"\n",(0,i.jsx)(n.p,{children:"an array of object which includes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"item"})," item to be stored."]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnally) ",(0,i.jsx)(n.code,{children:"condition"})," ",(0,i.jsx)(n.a,{href:"/docs/schema/data-types/String#condition-expression",children:"Condition expression"})," object."]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnally) ",(0,i.jsx)(n.a,{href:"./put/#setterInfo",children:"setterInfo"})]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnally) ",(0,i.jsx)(n.code,{children:"ReturnValuesOnConditionCheckFailure"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const res = await User.transactWrite({\n  put: [\n    {\n      // highlight-next-line\n      item: {\n        id: "user-64",\n        firstname: "John",\n        lastname: "Doe",\n        age: 27,\n        isActive: true,\n      },\n      // highlight-next-line\n      condition: {\n        age: {\n          $gt: 25,\n        },\n      },\n      // highlight-next-line\n      setterInfo: {\n        generateHash: true,\n      },\n    },\n  ],\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"update",children:"update"}),"\n",(0,i.jsx)(n.p,{children:"an array of object which includes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"condition"})," ",(0,i.jsx)(n.a,{href:"/docs/schema/data-types/String#condition-expression",children:"Condition expression"})," object with at least item identifier."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"set"})," any ",(0,i.jsx)(n.a,{href:"/docs/schema/data-types/String#update-expressions",children:"Update Expression"})," object."]}),"\n",(0,i.jsxs)(n.li,{children:["(optionnally) ",(0,i.jsx)(n.code,{children:"ReturnValuesOnConditionCheckFailure"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const res = await User.transactWrite({\n  update: [\n    {\n      condition: {\n        id: "user-64",\n        isActive: false,\n      },\n      set: {\n        firstname: "John",\n      },\n    },\n  ],\n});\n'})}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"All together"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const res = await User.transactWrite({\n  check: [\n    {\n      id: "user-07",\n      isActive: false,\n    },\n    {\n      id: "user-91",\n      isActive: true,\n    },\n  ],\n  put: [\n    {\n      item: {\n        id: "user-61",\n        firstname: "John",\n        lastname: "Doe",\n        age: 25,\n        isActive: true,\n      },\n      condition: {\n        age: {\n          $gt: 25,\n        },\n      },\n      setterInfo: {\n        generateHash: true,\n      },\n    },\n  ],\n  delete: [\n    {\n      condition: {\n        id: "user-32",\n        isActive: false,\n      },\n    },\n  ],\n  update: [\n    {\n      condition: {\n        id: "user-12",\n        isActive: false,\n      },\n      set: {\n        firstname: "Mike",\n      },\n    },\n  ],\n});\n'})})]}),"\n",(0,i.jsx)(n.h3,{id:"options",children:"options"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"options"})," is an object which accepts ",(0,i.jsx)(n.code,{children:"TransactWriteItemsCommandInput"})," options and DynamoQL specific options."]}),"\n",(0,i.jsx)(n.h4,{id:"exec",children:"exec"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"exec"})," boolean directive to execute or not the actual request.",(0,i.jsx)(n.br,{}),"\n","When ",(0,i.jsx)(n.code,{children:"false"})," transactWrite will return ",(0,i.jsx)(n.code,{children:"TransactWriteItemsCommandInput"})," object."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import type { TransactWriteItemsCommandInput } from "@aws-sdk/client-dynamodb";\n\nconst cmd: TransactWriteItemsCommandInput = await User.transactWrite(\n  {\n    check: [\n      {\n        id: "user-07",\n        isActive: true,\n      },\n    ],\n    update: [\n      {\n        condition: {\n          id: "user-12",\n          isActive: false,\n        },\n        set: {\n          friendsId: {\n            $push: "user-07",\n          },\n        },\n      },\n    ],\n  },\n  {\n    // highlight-next-line\n    exec: false,\n  }\n);\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>c});var i=t(7294);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);