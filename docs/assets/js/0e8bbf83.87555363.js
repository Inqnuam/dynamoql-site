"use strict";(self.webpackChunkdynamo_ql=self.webpackChunkdynamo_ql||[]).push([[7165],{689:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var o=r(5893),i=r(1151);const t={},s=void 0,a={id:"Error Handling",title:"Error Handling",description:"When working with DynamoQL, 3 type of error may be thrown:",source:"@site/docs/Error Handling.mdx",sourceDirName:".",slug:"/Error Handling",permalink:"/dynamoql-site/docs/Error Handling",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Extend Model",permalink:"/dynamoql-site/docs/model/Extend Model"},next:{title:"FAQ",permalink:"/dynamoql-site/docs/FAQ"}},d={},c=[];function l(n){const e={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.p,{children:"When working with DynamoQL, 3 type of error may be thrown:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"DynamoQL related error"}),"\n",(0,o.jsx)(e.li,{children:"aws-sdk v3 related error"}),"\n",(0,o.jsx)(e.li,{children:"runtime error"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["All DynamoQL related error are instances of ",(0,o.jsx)(e.code,{children:"DynamoQLException"}),".",(0,o.jsx)(e.br,{}),"\n","Here's hierarchy tree of all DynamoQL exceptions:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["DynamoQLException","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"DynamoQLForbiddenOperationException"}),"\n",(0,o.jsxs)(e.li,{children:["DynamoQLValidatorException","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"DynamoQLInvalidTypeException"}),"\n",(0,o.jsx)(e.li,{children:"DynamoQLMissingKeyException"}),"\n",(0,o.jsx)(e.li,{children:"DynamoQLInvalidEnumException"}),"\n",(0,o.jsx)(e.li,{children:"DynamoQLInvalidMinMaxException"}),"\n",(0,o.jsx)(e.li,{children:"DynamoQLCustomValidatorException"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"DynamoQLForbiddenOperationException"})," is thrown during update request when"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Removing a required attribute"}),"\n",(0,o.jsx)(e.li,{children:"Setting unknown attribute"}),"\n",(0,o.jsx)(e.li,{children:"Increasing / Decreasing an enum"}),"\n",(0,o.jsx)(e.li,{children:"using invalid $.. expression"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["Both ",(0,o.jsx)(e.code,{children:"DynamoQLForbiddenOperationException"})," and ",(0,o.jsx)(e.code,{children:"DynamoQLValidatorException"})," includes ",(0,o.jsx)(e.code,{children:"TableName"}),"."]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"DynamoQLValidatorException"})," includes ",(0,o.jsx)(e.code,{children:"details"}),", an object which provides attribute paths and error messages."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'import { DynamoQLException, DynamoQLValidatorException } from "dynamoql";\nimport { ProvisionedThroughputExceededException } from "@aws-sdk/client-dynamodb";\n\n// pseudo Express route middleware\nconst createUser = (req, res, next) => {\n  try {\n    await User.put(req.body);\n  } catch (error) {\n    if (error instanceof DynamoQLException) {\n      if (error instanceof DynamoQLValidatorException) {\n        return res.json(error);\n      }\n      // handle other error\n    } else if (error instanceof ProvisionedThroughputExceededException) {\n      // handle retry\n    } else {\n      next(error);\n    }\n  }\n};\n'})}),"\n",(0,o.jsx)(e.admonition,{type:"info",children:(0,o.jsxs)(e.p,{children:["When DynamoQLValidatorException is ",(0,o.jsx)(e.em,{children:"JSON.stringifed"}),"  it returns only ",(0,o.jsx)(e.code,{children:"details"})]})}),"\n",(0,o.jsxs)(e.admonition,{type:"tip",children:[(0,o.jsxs)(e.p,{children:["When overwriting an error message you can use ",(0,o.jsx)(e.a,{href:"/docs/schema/Advanced#gettypefromkeypath",children:"getTypeFromKeyPath"})," to get error related attribute Schema."]}),(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:'try {\n  await User.put(req.body);\n} catch (error) {\n  if (error instanceof DynamoQLInvalidEnumException) {\n    const frontendErrorMessages = {};\n\n    Object.entries(error).forEach(([key, message]) => {\n      const schema = userSchema.getTypeFromKeyPath(key);\n\n      frontendErrorMessages[key] = `\u0531\u0576\u057e\u0561\u057e\u0565\u0580 \u0574\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0578\u0582\u0574: \u0534\u0578\u0582\u0584 \u056f\u0561\u0580\u0578\u0572 \u0565\u0584 \u0585\u0563\u057f\u0561\u0563\u0578\u0580\u056e\u0565\u056c \u0574\u056b\u0561\u0575\u0576 ${schema.enum.join(", ")}`;\n    });\n\n    return frontendErrorMessages;\n  }\n}\n'})})]})]})}function h(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(l,{...n})}):l(n)}},1151:(n,e,r)=>{r.d(e,{Z:()=>a,a:()=>s});var o=r(7294);const i={},t=o.createContext(i);function s(n){const e=o.useContext(t);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),o.createElement(t.Provider,{value:e},n.children)}}}]);